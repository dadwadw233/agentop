# Claude Code Usage Tracking å†…éƒ¨å®ç°åˆ†æ

## ğŸ“Š æ¦‚è¿°

Claude Code ä½¿ç”¨**æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ**æ¥è¿½è¸ªä½¿ç”¨æƒ…å†µï¼Œå®Œå…¨åœ¨å®¢æˆ·ç«¯è¿›è¡Œç»Ÿè®¡ï¼Œä¸ä¾èµ–å®æ—¶APIè°ƒç”¨ã€‚

## ğŸ—‚ï¸ æ•°æ®å­˜å‚¨æ¶æ„

### æ ¸å¿ƒç›®å½•ç»“æ„

```
~/.claude/
â”œâ”€â”€ stats-cache.json          # ğŸ“Š èšåˆç»Ÿè®¡ç¼“å­˜ï¼ˆæ ¸å¿ƒï¼‰
â”œâ”€â”€ history.jsonl             # ğŸ“œ å‘½ä»¤å†å²è®°å½•
â”œâ”€â”€ projects/                 # ğŸ“ é¡¹ç›®çº§ä¼šè¯å­˜å‚¨
â”‚   â””â”€â”€ {project-path}/
â”‚       â””â”€â”€ {session-id}.jsonl  # ä¼šè¯è¯¦ç»†æ—¥å¿—
â”œâ”€â”€ debug/                    # ğŸ› è°ƒè¯•æ—¥å¿—
â”œâ”€â”€ file-history/             # ğŸ“„ æ–‡ä»¶æ“ä½œå†å²
â”œâ”€â”€ shell-snapshots/          # ğŸ“¸ ShellçŠ¶æ€å¿«ç…§
â””â”€â”€ settings.json             # âš™ï¸  ç”¨æˆ·è®¾ç½®
```

## ğŸ¯ stats-cache.json - æ ¸å¿ƒç»Ÿè®¡æ–‡ä»¶

### æ–‡ä»¶ç»“æ„

```json
{
  "version": 1,
  "lastComputedDate": "2026-01-13",

  // 1ï¸âƒ£ æ¯æ—¥æ´»åŠ¨ç»Ÿè®¡
  "dailyActivity": [
    {
      "date": "2026-01-13",
      "messageCount": 1073,      // æ¶ˆæ¯æ•°é‡
      "sessionCount": 67,        // ä¼šè¯æ•°é‡
      "toolCallCount": 213       // å·¥å…·è°ƒç”¨æ¬¡æ•°
    }
  ],

  // 2ï¸âƒ£ æ¯æ—¥æ¨¡å‹Tokenä½¿ç”¨
  "dailyModelTokens": [
    {
      "date": "2026-01-13",
      "tokensByModel": {
        "claude-haiku-4-5-20251001": 41735,
        "claude-sonnet-4-5-20250929": 99436
      }
    }
  ],

  // 3ï¸âƒ£ æ¨¡å‹ç´¯è®¡ä½¿ç”¨ï¼ˆå…¨éƒ¨æ—¶é—´ï¼‰
  "modelUsage": {
    "claude-sonnet-4-5-20250929": {
      "inputTokens": 79198,                    // è¾“å…¥token
      "outputTokens": 1074415,                 // è¾“å‡ºtoken
      "cacheReadInputTokens": 418184691,       // ç¼“å­˜è¯»å–token
      "cacheCreationInputTokens": 32663922,    // ç¼“å­˜åˆ›å»ºtoken
      "webSearchRequests": 0,                  // Webæœç´¢è¯·æ±‚æ•°
      "costUSD": 0,                            // è´¹ç”¨ï¼ˆç¾å…ƒï¼‰
      "contextWindow": 0,
      "maxOutputTokens": 0
    }
  },

  // 4ï¸âƒ£ æ€»ä½“ç»Ÿè®¡
  "totalSessions": 257,
  "totalMessages": 9507,
  "longestSession": {
    "sessionId": "6f06f9b8-f54e-46ea-a409-01e383be9d9f",
    "duration": 700213775,       // æ¯«ç§’
    "messageCount": 4657,
    "timestamp": "2025-12-04T13:33:41.984Z"
  },
  "firstSessionDate": "2025-12-04T13:33:41.984Z",

  // 5ï¸âƒ£ ä½¿ç”¨æ—¶æ®µåˆ†å¸ƒï¼ˆæŒ‰å°æ—¶ï¼‰
  "hourCounts": {
    "0": 2,   // 0ç‚¹: 2æ¬¡ä¼šè¯
    "3": 68,  // 3ç‚¹: 68æ¬¡ä¼šè¯ï¼ˆä½ çš„é«˜å³°æœŸï¼ï¼‰
    "15": 52, // 15ç‚¹: 52æ¬¡ä¼šè¯
    ...
  }
}
```

### æ•°æ®ç‰¹ç‚¹

âœ… **åŒ…å«çš„æ•°æ®**ï¼š
- ç²¾ç¡®çš„è¾“å…¥/è¾“å‡ºtokenç»Ÿè®¡
- ç¼“å­˜tokenç»Ÿè®¡ï¼ˆprompt cachingï¼‰
- æŒ‰æ¨¡å‹åˆ†ç±»çš„ä½¿ç”¨é‡
- æŒ‰æ—¥æœŸèšåˆçš„å†å²æ•°æ®
- ä¼šè¯å’Œæ¶ˆæ¯è®¡æ•°
- å·¥å…·è°ƒç”¨ç»Ÿè®¡

âŒ **ä¸åŒ…å«çš„æ•°æ®**ï¼š
- å®æ—¶quotaä¿¡æ¯ï¼ˆ5å°æ—¶/æœˆåº¦é™é¢ï¼‰
- å‰©ä½™quota
- å®é™…èŠ±è´¹é‡‘é¢ï¼ˆcostUSDå­—æ®µä¸º0ï¼‰
- å°æ—¶çº§åˆ«çš„è¯¦ç»†æ—¶é—´åºåˆ—

## ğŸ“ ä¼šè¯çº§è¿½è¸ª - JSONLæ—¥å¿—

### 1. history.jsonl - å…¨å±€å‘½ä»¤å†å²

```json
{
  "display": "ls",
  "pastedContents": {},
  "timestamp": 1764859780718,
  "project": "/Users/yuyuanhong/projects/playground",
  "sessionId": "fb519122-83d2-42e2-9655-8572479c70c1"
}
```

**ç”¨é€”**ï¼šè®°å½•æ‰€æœ‰æ‰§è¡Œçš„å‘½ä»¤ï¼Œç”¨äºå†å²å›æº¯ã€‚

### 2. é¡¹ç›®ä¼šè¯æ—¥å¿— - {session-id}.jsonl

**è·¯å¾„**ï¼š`~/.claude/projects/{project-path}/{session-id}.jsonl`

**ç¤ºä¾‹ç»“æ„**ï¼š
```json
{
  "parentUuid": null,
  "isSidechain": false,
  "userType": "external",
  "cwd": "/Users/yuyuanhong/projects/agentop",
  "sessionId": "e0bab6cd-5809-47b3-b7ca-7b817a4613f1",
  "version": "2.1.6",
  "gitBranch": "",
  "type": "system",
  "subtype": "local_command",
  "content": "...",              // å®é™…å†…å®¹
  "level": "info",
  "timestamp": "2026-01-13T19:58:42.022Z",
  "uuid": "d1cd4a1f-c768-4832-9570-cf42d696c21b",
  "isMeta": false
}
```

**ç‰¹ç‚¹**ï¼š
- æ¯è¡Œä¸€ä¸ªJSONå¯¹è±¡ï¼ˆJSONLæ ¼å¼ï¼‰
- è®°å½•å®Œæ•´çš„ä¼šè¯ä¸Šä¸‹æ–‡
- åŒ…å«æ¶ˆæ¯å†…å®¹ã€å·¥å…·è°ƒç”¨ã€ç³»ç»Ÿäº‹ä»¶
- ç”¨äºä¼šè¯æ¢å¤å’Œå†å²æŸ¥çœ‹

## ğŸ”„ ç»Ÿè®¡æ›´æ–°æœºåˆ¶

### æ›´æ–°æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·äº¤äº’       â”‚
â”‚  (æ¶ˆæ¯/å·¥å…·è°ƒç”¨) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼šè¯æ—¥å¿—å†™å…¥    â”‚
â”‚  {session}.jsonlâ”‚ â† å®æ—¶å†™å…¥
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åå°èšåˆä»»åŠ¡    â”‚
â”‚  (å®šæœŸè§¦å‘)     â”‚ â† å¯èƒ½æ˜¯å®šæ—¶ä»»åŠ¡æˆ–ä¼šè¯ç»“æŸæ—¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ›´æ–°ç»Ÿè®¡ç¼“å­˜    â”‚
â”‚  stats-cache.jsonâ”‚ â† æ‰¹é‡æ›´æ–°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ›´æ–°æ—¶æœº

æ ¹æ®è§‚å¯Ÿï¼Œ`stats-cache.json` çš„ `lastComputedDate` æ˜¾ç¤ºä¸º "2026-01-13"ï¼Œè€Œä»Šå¤©æ˜¯ 1æœˆ14æ—¥ï¼Œè¯´æ˜ï¼š

1. **ä¸æ˜¯å®æ—¶æ›´æ–°**ï¼šç»Ÿè®¡æœ‰å»¶è¿Ÿï¼ˆé€šå¸¸æ˜¯ä¸€å¤©ï¼‰
2. **æ‰¹é‡å¤„ç†**ï¼šå¯èƒ½åœ¨ä¼šè¯ç»“æŸæˆ–æ¯æ—¥å®šæ—¶ä»»åŠ¡æ—¶æ›´æ–°
3. **å¼‚æ­¥èšåˆ**ï¼šä¸å½±å“å®æ—¶æ€§èƒ½

## ğŸ’¡ Tokenç»Ÿè®¡å®ç°

### Claude Codeå¦‚ä½•ç»Ÿè®¡Token

**æ¥æº**ï¼šClaude APIå“åº”

æ¯æ¬¡APIè°ƒç”¨è¿”å›çš„å“åº”åŒ…å«tokenç»Ÿè®¡ï¼š

```json
{
  "usage": {
    "input_tokens": 1234,
    "output_tokens": 5678,
    "cache_creation_input_tokens": 100,
    "cache_read_input_tokens": 2000
  }
}
```

**å¤„ç†æµç¨‹**ï¼š

```python
# ä¼ªä»£ç ç¤ºä¾‹
async def track_api_call(model, request, response):
    # 1. ä»APIå“åº”æå–token
    usage = response.usage

    # 2. ç´¯åŠ åˆ°ä¼šè¯ç»Ÿè®¡
    session_stats.add_tokens(
        model=model,
        input_tokens=usage.input_tokens,
        output_tokens=usage.output_tokens,
        cache_read=usage.cache_read_input_tokens,
        cache_creation=usage.cache_creation_input_tokens
    )

    # 3. å†™å…¥ä¼šè¯æ—¥å¿—
    write_jsonl(session_log, {
        'type': 'api_call',
        'model': model,
        'usage': usage,
        'timestamp': now()
    })

    # 4. å¼‚æ­¥æ›´æ–°èšåˆç»Ÿè®¡ï¼ˆæ‰¹é‡å¤„ç†ï¼‰
    schedule_stats_update()
```

### Prompt Cachingçš„ç‰¹æ®Šå¤„ç†

Claude Code ç‰¹åˆ«è¿½è¸ªäº†**ç¼“å­˜token**ï¼š

- `cacheReadInputTokens`ï¼šä»ç¼“å­˜è¯»å–ï¼ˆä»·æ ¼ä¾¿å®œï¼‰
- `cacheCreationInputTokens`ï¼šåˆ›å»ºç¼“å­˜ï¼ˆé¦–æ¬¡æˆæœ¬ï¼‰

**ä½ çš„å®é™…ä½¿ç”¨**ï¼š
```json
"claude-sonnet-4-5-20250929": {
  "inputTokens": 79198,              // ç›´æ¥è¾“å…¥
  "outputTokens": 1074415,           // è¾“å‡º
  "cacheReadInputTokens": 418184691, // ğŸ˜± å·¨é‡ç¼“å­˜è¯»å–ï¼
  "cacheCreationInputTokens": 32663922
}
```

**åˆ†æ**ï¼šä½ çš„ç¼“å­˜è¯»å–é‡æ˜¯ç›´æ¥è¾“å…¥çš„**5000å€**ï¼è¿™è¯´æ˜Claude Codeå¤§é‡ä½¿ç”¨äº†prompt cachingæ¥ä¼˜åŒ–æˆæœ¬ã€‚

## ğŸ“ˆ ç»Ÿè®¡æ•°æ®çš„ç²¾åº¦

### âœ… é«˜ç²¾åº¦æ•°æ®

- **Tokenè®¡æ•°**ï¼š100%å‡†ç¡®ï¼ˆç›´æ¥æ¥è‡ªAPIï¼‰
- **ä¼šè¯/æ¶ˆæ¯è®¡æ•°**ï¼š100%å‡†ç¡®ï¼ˆæœ¬åœ°è®°å½•ï¼‰
- **æ¨¡å‹ä½¿ç”¨**ï¼š100%å‡†ç¡®ï¼ˆæŒ‰æ¨¡å‹åˆ†ç±»ï¼‰

### âš ï¸  ä¼°ç®—æ•°æ®

- **æ¯æ—¥token**ï¼šåªæœ‰æ€»é‡ï¼Œæ— è¾“å…¥/è¾“å‡ºåˆ†è§£
- **è´¹ç”¨**ï¼š`costUSD`å­—æ®µä¸º0ï¼ˆå¯èƒ½éšç§è€ƒè™‘ï¼‰
- **5å°æ—¶quota**ï¼šå®Œå…¨ä¸è¿½è¸ª

### âŒ ç¼ºå¤±æ•°æ®

- **å®æ—¶quotaä½¿ç”¨**ï¼šAPIä¸è¿”å›
- **Quotaå‰©ä½™é‡**ï¼šAPIä¸è¿”å›
- **ç²¾ç¡®çš„å°æ—¶çº§æ•°æ®**ï¼šåªæœ‰ä¼šè¯è®¡æ•°ï¼Œæ— token

## ğŸ” ä¸ºä»€ä¹ˆAPIä¸è¿”å›Quotaä¿¡æ¯ï¼Ÿ

### æŠ€æœ¯åŸå› 

1. **åˆ†å¸ƒå¼æ¶æ„**ï¼šQuotaåœ¨åç«¯ç‹¬ç«‹æœåŠ¡ç®¡ç†
2. **å®‰å…¨è€ƒè™‘**ï¼šé¿å…å®¢æˆ·ç«¯æ“çºµquotaæ£€æŸ¥
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šä¸åœ¨æ¯æ¬¡APIå“åº”ä¸­è®¡ç®—quota

### è®¾è®¡å“²å­¦

```
Anthropicçš„è®¾è®¡åŸåˆ™ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  APIå±‚ï¼šä¸“æ³¨è¿”å›å†…å®¹        â”‚
â”‚  âœ“ Tokenç»Ÿè®¡                â”‚
â”‚  âœ“ ç¼“å­˜å‘½ä¸­ç‡               â”‚
â”‚  âœ“ æ¨¡å‹ä¿¡æ¯                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯å±‚ï¼šQuotaç®¡ç†åˆ†ç¦»      â”‚
â”‚  â€¢ Rate limiting            â”‚
â”‚  â€¢ Quota enforcement        â”‚
â”‚  â€¢ ä»…åœ¨è¶…é™æ—¶æ‹’ç»è¯·æ±‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ç”¨æˆ·éœ€è¦é€šè¿‡**Web Dashboard**æŸ¥çœ‹quotaï¼Œè€ŒéAPIã€‚

## ğŸ› ï¸ Claude Codeçš„å®ç°ç»†èŠ‚ï¼ˆæ¨æµ‹ï¼‰

### æ¶æ„æ¨¡å¼

```typescript
// å¯èƒ½çš„å®ç°æ¶æ„

class UsageTracker {
  private sessionLog: JSONLWriter;
  private statsCache: StatsCache;

  async trackInteraction(interaction: Interaction) {
    // 1. å®æ—¶å†™å…¥ä¼šè¯æ—¥å¿—
    await this.sessionLog.append({
      timestamp: Date.now(),
      type: interaction.type,
      content: interaction.content,
      model: interaction.model
    });

    // 2. å¦‚æœæ˜¯APIè°ƒç”¨ï¼Œè®°å½•token
    if (interaction.type === 'api_response') {
      this.statsCache.incrementTokens(
        interaction.model,
        interaction.usage.input_tokens,
        interaction.usage.output_tokens
      );
    }
  }

  async computeDailyStats() {
    // å®šæœŸä»»åŠ¡ï¼šèšåˆä¼šè¯æ—¥å¿—åˆ°stats-cache.json
    const sessions = await this.loadAllSessions(today);
    const aggregated = this.aggregate(sessions);
    await this.statsCache.save(aggregated);
  }
}
```

### æ–‡ä»¶ç³»ç»Ÿæ“ä½œ

- **JSONLè¿½åŠ å†™å…¥**ï¼šé«˜æ•ˆçš„æ—¥å¿—è¿½åŠ ï¼ˆO(1)ï¼‰
- **æ‰¹é‡è¯»å–èšåˆ**ï¼šå®šæœŸè¯»å–æ‰€æœ‰ä¼šè¯æ—¥å¿—ï¼Œèšåˆåˆ°ç¼“å­˜
- **åŸå­æ€§æ›´æ–°**ï¼šä½¿ç”¨ä¸´æ—¶æ–‡ä»¶+é‡å‘½åä¿è¯stats-cache.jsonå®Œæ•´æ€§

## ğŸ“Š ä¸Agentopçš„å¯¹æ¯”

| åŠŸèƒ½ | Claude Code | Agentop |
|------|-------------|---------------|
| **æ•°æ®æ¥æº** | æœ¬åœ°JSONL + APIå“åº” | è¯»å–stats-cache.json |
| **Tokenç»Ÿè®¡** | ç›´æ¥ä»APIè·å–ï¼ˆç²¾ç¡®ï¼‰ | ä»ç¼“å­˜è¯»å– |
| **å®æ—¶æ€§** | ä¼šè¯çº§å®æ—¶ | ä¾èµ–ç¼“å­˜æ›´æ–°ï¼ˆå»¶è¿Ÿï¼‰ |
| **Quotaè¿½è¸ª** | âŒ ä¸è¿½è¸ª | âœ… ç”¨æˆ·é…ç½®ä¼°ç®— |
| **å†å²æ•°æ®** | âœ… å®Œæ•´JSONLæ—¥å¿— | âœ… è¯»å–èšåˆç»Ÿè®¡ |
| **5å°æ—¶çª—å£** | âŒ æ—  | âœ… ä¼°ç®—å®ç° |

## ğŸ¯ å…³é”®å‘ç°

### 1. Claude Codeä¸æä¾›Quota API

```python
# âŒ è¿™æ ·çš„APIä¸å­˜åœ¨
quota_info = claude.get_quota()

# âœ… åªèƒ½åœ¨DashboardæŸ¥çœ‹
# https://console.anthropic.com
```

### 2. stats-cache.jsonæ˜¯å”¯ä¸€çš„æœ¬åœ°ç»Ÿè®¡æº

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆAgentopå¿…é¡»ï¼š
- è¯»å–è¿™ä¸ªæ–‡ä»¶è·å–ä½¿ç”¨æ•°æ®
- ç”¨æˆ·æ‰‹åŠ¨é…ç½®quotaé™åˆ¶
- ä¼°ç®—5å°æ—¶çª—å£ï¼ˆæ— å®é™…æ•°æ®ï¼‰

### 3. ç¼“å­˜Tokenå æ¯”å·¨å¤§

ä½ çš„ç»Ÿè®¡æ˜¾ç¤ºï¼š
```
ç¼“å­˜è¯»å–: 418M tokens
ç›´æ¥è¾“å…¥: 79K tokens
æ¯”ä¾‹: 5279:1 âš¡
```

è¿™æ„å‘³ç€Claude Codeé€šè¿‡prompt cachingèŠ‚çœäº†**å·¨é¢æˆæœ¬**ï¼

## ğŸ’° æˆæœ¬ä¼˜åŒ–ç­–ç•¥

åŸºäºä½ çš„æ•°æ®ï¼š

```python
# ä½ çš„å®é™…ä½¿ç”¨ï¼ˆå…¨éƒ¨æ—¶é—´ï¼‰
sonnet_usage = {
    'input': 79_198,
    'output': 1_074_415,
    'cache_read': 418_184_691,
    'cache_creation': 32_663_922
}

# å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œæˆæœ¬å¯¹æ¯”
without_cache = (79198 + 418184691) / 1_000_000 * 3  # inputä»·æ ¼
with_cache = (79198 / 1_000_000 * 3 +                # input
              418184691 / 1_000_000 * 0.3)           # cache read (10æŠ˜)

print(f'æ— ç¼“å­˜æˆæœ¬: ${without_cache:.2f}')
print(f'æœ‰ç¼“å­˜æˆæœ¬: ${with_cache:.2f}')
print(f'èŠ‚çœ: ${without_cache - with_cache:.2f}')
```

**é¢„ä¼°èŠ‚çœ**ï¼šä½¿ç”¨prompt cachingå¯èƒ½èŠ‚çœäº†**90%+çš„è¾“å…¥tokenæˆæœ¬**ï¼

## ğŸ”® æœªæ¥æ”¹è¿›æ–¹å‘

å¦‚æœAnthropicæœªæ¥æä¾›Quota APIï¼š

```python
# ç†æƒ³çš„APIè®¾è®¡
response = client.messages.create(
    model="claude-sonnet-4",
    messages=[...]
)

# æœŸæœ›è¿”å›çš„quotaä¿¡æ¯
print(response.quota_info)
# {
#   "five_hour_window": {
#     "limit": 500000,
#     "used": 45200,
#     "remaining": 454800,
#     "reset_at": "2026-01-14T18:30:00Z"
#   },
#   "monthly": {
#     "limit": 5000000,
#     "used": 461270,
#     "remaining": 4538730
#   }
# }
```

é‚£ä¹ˆAgentopå°±å¯ä»¥ç›´æ¥æ˜¾ç¤º**ç²¾ç¡®çš„quotaä¿¡æ¯**ï¼Œè€Œä¸éœ€è¦ç”¨æˆ·æ‰‹åŠ¨é…ç½®ï¼

## ğŸ“š æ€»ç»“

Claude Codeçš„usage trackingæ˜¯ä¸€ä¸ª**å®¢æˆ·ç«¯èšåˆç³»ç»Ÿ**ï¼š

1. **å®æ—¶è®°å½•**ï¼šæ¯æ¬¡äº¤äº’å†™å…¥JSONLæ—¥å¿—
2. **APIæ•°æ®**ï¼šä»Claude APIå“åº”è·å–ç²¾ç¡®tokenç»Ÿè®¡
3. **æ‰¹é‡èšåˆ**ï¼šå®šæœŸå°†æ—¥å¿—èšåˆåˆ°stats-cache.json
4. **ç¼“å­˜ä¼˜åŒ–**ï¼šå¤§é‡ä½¿ç”¨prompt cachingé™ä½æˆæœ¬
5. **æ— Quota API**ï¼šquotaä¿¡æ¯ä»…åœ¨Web Dashboardå¯è§

Agentopé€šè¿‡è¯»å–stats-cache.jsonè·å–ä½¿ç”¨æ•°æ®ï¼Œå¹¶å®ç°ç”¨æˆ·é…ç½®çš„quotaè¿½è¸ªåŠŸèƒ½ï¼Œå¼¥è¡¥äº†APIçš„ä¸è¶³ã€‚

---

**å…³é”®æ–‡ä»¶ä½ç½®**ï¼š
- ç»Ÿè®¡ç¼“å­˜ï¼š`~/.claude/stats-cache.json`
- ä¼šè¯æ—¥å¿—ï¼š`~/.claude/projects/{project}/{session}.jsonl`
- å‘½ä»¤å†å²ï¼š`~/.claude/history.jsonl`

**Agentopçš„ä»·å€¼**ï¼š
- âœ… å®æ—¶å¯è§†åŒ–ï¼ˆTUIï¼‰
- âœ… Quotaä¼°ç®—å’Œå‘Šè­¦
- âœ… è¿›ç¨‹ç›‘æ§
- âœ… æˆæœ¬è¿½è¸ª
